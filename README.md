# Отчёт о выполнении лабораторной работы №3

## Постановка задачи

Расширение компонента CEcoLab1 системой событий для пошаговой визуализации алгоритма пузырьковой сортировки с поддержкой схем "один-ко-многим" и "многие-к-одному".

## Реализованная архитектура

### Компоненты системы

- **CEcoLab1** - основной компонент с алгоритмом сортировки
- **CEcoLab1Sink** - приемник событий  
- **IEcoLab1Events** - интерфейс событий для отслеживания работы алгоритма
- **IEcoConnectionPointContainer** - управление точками подключения

### Схема подключений

Sink 1 ──────→ Component 1 ←────── Sink 2

│

├──────────→ Component 2

│

└──────────→ Component 3

## Функциональность компонента

Компонент CEcoLab1 предоставляет следующие интерфейсы:

**IEcoLab1:**
- `BubbleSort()` - пузырьковая сортировка
- `ArrayGen()` - генерация тестовых массивов

**IEcoLab1Events:**
- `OnSortSwap()` - событие обмена элементов
- `OnSortCompare()` - событие сравнения элементов  
- `OnSortIteration()` - событие новой итерации

## Тестирование

Было проведено комплексное тестирование, демонстрирующее работу системы в различных сценариях:

**Тестирование системы событий** подтвердило корректность работы механизма обратных вызовов через интерфейс IEcoConnectionPointContainer. Была успешно реализована модель "один-ко-многим" (Component 1 -> Sink 1 + Sink 2) и "многие-к-одному" (Component 2 + Component 3 -> Sink 1).

- Тест 1: One Source -> Two Sinks - проверка рассылки событий от одного компонента к нескольким приемникам

- Тест 2: One Source -> One Sink - проверка прямого подключения компонента к единственному приемнику

- Тест 3: Multiple Sources -> One Sink - проверка работы одного приемника с событиями от нескольких источников

**Тестирование алгоритма сортировки** проводилось на малых массивах для демонстрации генерации событий сравнения, обмена элементов и итераций процесса сортировки. Алгоритм корректно генерировал все типы событий и успешно завершал сортировку.

**Тестирование управления подключениями** продемонстрировало корректную работу механизмов Advise/Unadvise, включая множественные подключения к одному компоненту и корректное освобождение ресурсов при отключении обработчиков событий.

Все тесты завершились успешно, подтвердив корректность работы алгоритма сортировки, системы событий и управления жизненным циклом объектов.
